---
title: kafka server.properties에 대해 설명
categories:
  - kafka
tags: 
  - server
---

kafka를 시작할 때  server.properties에 대해 설명합니다.

Apache Kafka의 server.properties 파일에서 설정할 수 있는 항목인 num.partitions와 default.replication.factor에 대해 상세하게 설명하겠습니다.

- num.partitions
설명: num.partitions는 새로운 토픽이 생성될 때 기본적으로 생성되는 파티션의 수를 설정합니다. 파티션은 Kafka의 분산 메시징 시스템의 핵심 구성 요소로, 데이터를 처리하고 저장하는 단위 입니다.  

용도: 이 설정은 토픽의 초기 파티션 수를 정의하며, 더 많은 파티션을 설정할수록 데이터 병렬 처리 성능이 증가합니다. 하지만 각 파티션은 별도의 오버헤드를 가지므로, 파티션 수를 잘 고려하여 설정해야 합니다.  

기본값: Kafka의 기본값은 1입니다. 별도로 파티션 수를 설정하지 않고 토픽을 생성할 경우, 이 설정이 적용됩니다.  
즉, 새로운 토픽이 생성될 때 기본적으로 1개의 파티션이 생성됩니다.  
새로운 토픽은 기본적으로 하나의 파티션을 가지며, 필요한 경우 이 값을 늘려 성능 향상을 도모할 수 있습니다.

- default.replication.factor
설명: default.replication.factor는 새롭게 생성되는 토픽의 기본 복제본(replica)의 개수를 정의합니다. 복제본은 각 파티션의 데이터를 다른 브로커에 복사하여, 데이터 가용성과 내구성을 높이는 역할을 합니다. 장애 발생 시에도 데이터 손실을 최소화하기 위해 이 값을 2 이상으로 설정하는 것이 일반적입니다.  
**복제본의 수는 클러스터 내의 브로커 수보다 클 수 없습니다.**

용도: 이 설정은 데이터의 내구성과 가용성을 높이는 데 중요한 역할을 합니다. 예를 들어, 복제 인자가 3이라면, 각 파티션의 데이터는 3개의 브로커에 복제됩니다. 이를 통해 브로커 중 하나가 실패하더라도 데이터 손실 없이 서비스가 계속 운영될 수 있습니다.  

기본값: Kafka의 기본값은 1입니다. 
즉, 복제가 설정되지 않으면 기본적으로 각 파티션은 단일 브로커에만 저장됩니다.  
기본적으로 복제본이 생성되지 않아, 데이터 손실 위험이 있을 수 있습니다.  

- listeners
설명:

Kafka 브로커가 클라이언트 또는 다른 브로커와 통신할 때 사용할 네트워크 주소(호스트와 포트)를 지정합니다. 브로커가 수신 대기할 네트워크 인터페이스와 프로토콜을 정의하며, 여러 프로토콜을 동시에 사용할 수 있습니다. 예를 들어, PLAINTEXT, SSL, SASL_PLAINTEXT 등의 프로토콜을 사용할 수 있습니다.
이 설정은 Kafka 브로커가 클라이언트로부터의 요청을 수신할 IP 주소와 포트를 설정합니다.
기본값:

PLAINTEXT://:9092. 기본적으로 PLAINTEXT 프로토콜을 사용하며, 포트는 9092번을 사용합니다. 보안이 필요한 경우 SSL 또는 SASL을 사용하여 통신을 암호화할 수 있습니다.

요약
num.partitions: 기본 파티션 수 (기본값: 1)  
default.replication.factor: 기본 복제 인자 (기본값: 1)  
이 설정들은 Kafka 토픽의 성능 및 내구성에 직접적인 영향을 미치므로, 운영 환경 및 요구 사항에 맞춰 적절히 조정하는 것이 중요합니다.

## setup kafka
kafka가 설치된 KAFKA_HOME directory 아래에 config/server.properties에서 아래 4개의 항목을 수정합니다.  
- broker.id
- log.dir
- advertised.listeners
- zookeeper.connect

#### broker.id
**broker.id**
설명:

Kafka 클러스터에서 각 브로커를 구분하는 고유한 ID입니다.  
클러스터 내에서 각각의 Kafka 브로커가 동일한 broker.id를 가질 수 없으며, 이 값은 정수로 설정됩니다. Kafka 브로커는 클러스터 내에서 유일해야 하기 때문에, broker.id가 브로커를 식별하는 중요한 역할을 합니다.  
클러스터 내에서 브로커가 메타데이터 상에서 고유하게 식별되도록 하는 데 사용되며, 이 ID는 Zookeeper나 Kafka Controller에 의해 관리됩니다.  
이 값은 브로커가 재시작될 때도 유지되어야 하며, 클러스터에서 브로커를 식별하는 데 중요한 역할을 합니다.

기본값:

기본값은 0으로 설정되어 있습니다. 클러스터를 구성할 때 이 값은 반드시 수정해야하며,  
브로커를 시작하려면 반드시 설정해야 하는 필수 항목입니다.

#### log.dirs
Kafka 브로커가 메시지 데이터를 저장하는 디렉토리 경로를 지정합니다. 각 브로커는 수신한 메시지를 로컬 디스크에 저장하며, 이 디렉토리는 파티션 데이터와 로그 세그먼트 파일들이 저장되는 위치입니다. 여러 디렉토리를 쉼표로 구분하여 지정할 수 있으며, Kafka는 여러 디스크에 데이터를 분산 저장할 수 있습니다.  
이 경로는 브로커의 저장 용량 관리에 중요한 역할을 하므로 적절한 디스크 공간이 있는 경로를 설정해야 합니다.  
기본값:

/tmp/kafka-logs. 디폴트로 임시 디렉토리에 저장되며, 실제 운영 환경에서는 적절한 경로로 변경해야 합니다.  

#### advertised.listeners
- advertised.listeners
설명:

외부 클라이언트나 다른 브로커가 이 브로커에 접근할 때 사용할 네트워크 주소를 지정합니다. 이는 listeners 설정과 다르게, 브로커가 내부 네트워크에서 사용하는 IP와는 다른 IP(예: 외부 접근을 허용하는 공인 IP)일 수 있습니다.
외부에서 브로커에 접근할 때 이 주소를 통해 연결됩니다. 예를 들어, 브로커가 내부적으로 여러 네트워크 인터페이스를 가질 수 있는 경우, 외부 클라이언트는 advertised.listeners에 설정된 주소로 연결합니다.
기본값:

기본값은 없습니다. 설정하지 않을 경우, listeners의 값이 클라이언트들에게 광고됩니다. 그러나, 일반적으로 외부 클라이언트가 접근할 주소를 명시적으로 설정하는 것이 좋습니다.  

#### zookeeper.connect
Kafka 브로커가 연결할 Zookeeper의 주소를 지정합니다. Zookeeper는 Kafka 클러스터의 메타데이터를 관리하며, 브로커와 토픽의 상태를 조율하는 역할을 합니다. Zookeeper 연결 문자열은 Zookeeper 서버의 호스트 이름 또는 IP와 포트 번호로 구성됩니다.  

예시: 
```ini
zookeeper.connect=localhost:2181
```
기본값:

기본값은 없습니다. Zookeeper의 주소는 필수적으로 설정해야 합니다. Zookeeper가 여러 개 있을 경우 쉼표로 구분하여 설정합니다.