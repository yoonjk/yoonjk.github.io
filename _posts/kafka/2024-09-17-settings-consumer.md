---
title: setting kafka consumer
categories:
  - kafka
tags: 
  - consumer
---

#### fetch.min.bytes
fetch.min.bytes는 소비자가 서버에서 데이터를 가져올 때 한 번에 수신하려는 최소 데이터 크기(바이트 단위)를 정의하는 설정입니다.  
즉, 이 값보다 적은 데이터를 서버로부터 받지 않겠다는 의미입니다. Kafka는 소비자가 요청한 최소 데이터 크기만큼의 데이터를 준비할 때까지 기다렸다가 데이터를 전송합니다.  
이 값을 크게 설정하면, 소비자는 한 번에 많은 데이터를 받아 네트워크 요청 횟수를 줄일 수 있습니다. 하지만, 기다리는 동안 데이터가 적게 도착하면 지연이 발생할 수 있습니다.  

사용 사례:

고성능 또는 대량 데이터 처리가 필요한 경우 이 값을 크게 설정하여 네트워크 효율을 높일 수 있습니다.
반대로 지연을 최소화하려면 이 값을 작게 설정하여 즉시 가능한 데이터를 가져올 수 있습니다.  

기본값: 1 byte

1 byte. 소비자는 기본적으로 한 번의 요청에서 1 바이트 이상의 데이터를 가져오며, 그 이하로는 기다리지 않습니다.

#### fetch.max.wait.ms
fetch.max.wait.ms는 소비자가 서버에서 데이터를 요청한 후, 응답을 기다릴 수 있는 최대 시간(밀리초)을 설정합니다.  
소비자가 데이터를 요청했을 때, 서버는 fetch.min.bytes로 설정한 최소 데이터 크기를 맞추기 위해 필요한 시간이 있으면 기다립니다. 만약 이 시간이 fetch.max.wait.ms보다 길어지면, 최소 크기에 상관없이 서버는 현재 가능한 데이터를 즉시 전송합니다.  
이 설정은 최소 데이터를 수신하기 위해 기다리는 시간을 제한하며, 데이터가 부족한 상황에서도 응답이 늦어지지 않도록 보장합니다.  

사용 사례:

지연을 줄이기 위해서 이 값을 줄여 서버가 데이터를 빠르게 반환하도록 하거나,
효율적인 네트워크 사용을 위해서 이 값을 늘려 더 많은 데이터를 한꺼번에 수신할 수 있도록 합니다.  

기본값: 500 ms  

500 ms. 서버는 기본적으로 소비자가 요청한 데이터를 최대 500ms 동안 기다렸다가 fetch.min.bytes 기준을 충족하지 못해도 현재 가능한 데이터를 응답합니다.

fetch.min.bytes와 fetch.max.wait.ms의 관계:

**fetch.min.bytes**는 소비자가 수신하고자 하는 최소 데이터 크기를 정의하고, **fetch.max.wait.ms**는 그 데이터를 준비하는 데 서버가 기다릴 수 있는 최대 시간을 설정합니다.   

서버는 소비자가 요청한 최소 크기의 데이터를 준비하기 위해 기다리지만, 이 시간이 fetch.max.wait.ms를 넘지 않도록 보장합니다.
예시: 소비자가 100KB의 데이터를 fetch.min.bytes로 요청했지만, 서버가 500ms 동안 그만큼의 데이터를 수집하지 못하면, 현재 가능한 데이터 크기와 상관없이 500ms 뒤에 데이터를 전송하게 됩니다.  

이 두 설정은 **지연(latency)**과 처리량(throughput) 간의 균형을 조절하는 데 사용됩니다.

